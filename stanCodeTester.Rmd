---
title: "stanCodeTester"
author: "Yufang"
date: "2025-03-06"
output: pdf_document
---

# Test the bSplines
```{r, echo=TRUE}
install.packages("splines2")
install.packages("rstan")
library(splines2)
library(rstan)

set.seed(123)
x <- seq(0, 10, length.out = 100)
y <- sin(x) + rnorm(100, sd = 0.2)
bs_basis <- bSpline(x, df = 10)


stan_data <- list(
  N = length(x),
  K = ncol(bs_basis),
  x = x,
  y = y,
  bs_basis = bs_basis
)


stan_model_code <- " 
data {
  int<lower=0> N;
  int<lower=0> K;
  matrix[N, K] bs_basis;
  vector[N] y;
  }
parameters {
  vector[K] beta;
  real<lower=0> sigma;
  }
model {
  y ~ normal(bs_basis * beta, sigma);
  }
"
stan_model <- stan_model(model_code = stan_model_code)
fit <- sampling(stan_model, data = stan_data, iter = 2000, chains = 4)
print(fit)
```
