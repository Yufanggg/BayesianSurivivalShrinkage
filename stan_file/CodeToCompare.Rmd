---
title: "CodeToCompare"
author: "Yufang"
date: "2025-03-31"
output: html_document
---


# Generate simulated data
```{r, echo=TRUE}
rm(list = ls())
setwd("C:/Users/Alisa_Wang/Desktop/MasterThesis/Code/")
source("./function_file/NecessaryFunction_CodeComparsion.R")
set.seed(123)

n_samples <- 200
n_features <- 10

# function for one simulation
simulation_bayint_survival <- function(criteria = "DesignCoefficients", withPrediction = FALSE){
  simulated_data <- DataGenerator(n_samples = 210, n_features = 10)
  dataset <- simulated_data$dataset
  Beta <- simulated_data$Beta
  
  #constructor data for the model
  if (withPrediction) {
    stan_data_bSplines <- stan_data_Constructer(
      training_dataset = dataset,
      testing_dataset = head(dataset, 10),
      baseline_modelling = "bSplines",
      obs_window = 5
    )
  }
  else{
    stan_data_bSplines <- stan_data_Constructer(
      training_dataset = dataset,
      testing_dataset = head(dataset, 10),
      baseline_modelling = "bSplines",
      obs_window = 5
    )
  }
    
  #fit model
  model_fit_bSplines <- Bayesian_Survival_model(stan_data = stan_data_bSplines, baseline_assumption = "bSplines")

  # model fit checking
  print(summary(model_fit_bSplines))
  #Bayesian_Survival_model_check(model_fit_bSplines, criteria = c("MCMC chain", "MCMC autocorrelations"))
  
  #extract the info from the bayesian model fit
  model_result_bSplines <- Bayesian_Survival_result_Extract(bayesian_model_fit = model_fit_bSplines, criteria = criteria)
  
  
  output = list(
    Beta_true = Beta,
    Beta_est_bSplines = model_result_bSplines$Beta_bayesian_est[, "mean"]
  )
  
  return(output)
}

simulated_results <- replicate(1, simulation_bayint_survival(), simplify = "array")

```

# 